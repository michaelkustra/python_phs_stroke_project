# load in stroke activity by health board data
import pandas as pd
from pyprojroot import here
stroke_activity_hb = pd.read_csv(here('raw_data/stroke_activitybyhbr.csv'))
# explore health board dimensions
stroke_activity_hb.shape
# summary statistics on numeric columns
stroke_activity_hb.describe()
# remove unnecessary columns
stroke_activity_hb_reduced = r.stroke_activity_hb.drop(columns = ['hbrqf', 'admission_type_qf', 'age_group_qf', 'sex_qf', 'number_of_discharges_qf', 'crude_rate_qf'])
# filter for Scotland wide stroke numbers for all patients
common_df = stroke_activity_hb_reduced.query('admission_type == "All" & age_group == "All" & sex == "All"')
# most common stroke diagnosis by total number of discharges
common_df.groupby('diagnosis').sum()
# most common stroke diagnosis by year and number of discharges
common_df.groupby(['financial_year', 'diagnosis']).sum()
# mean crude rate and EASR across all years in all health board
common_df.groupby('diagnosis').mean()
# mean crude rate and EASR across each year and all health boards
common_df.groupby(['financial_year', 'diagnosis']).mean()
sex_df = stroke_activity_hb_reduced.query('sex != "All" & age_group == "All"')
gender_df = sex_df.groupby(['diagnosis', 'sex'])['crude_rate'].mean().reset_index()
age_df = gender_df.query('diagnosis == "Subarachnoid Haemorrhage" | diagnosis == "TIAs and related syndromes"' )
import matplotlib
import matplotlib.pyplot as plt
import numpy as np
plt.style.use('ggplot')
x = ['Subarachnoid Haemorrhage', 'TIAs and related syndromes']
y_sub_crude = [19.70330, 10.87919]
z_tias_crude = [36.66311, 35.04374]
X_axis = np.arange(len(x))
plt.bar(X_axis - 0.2, y_sub_crude, 0.4, label = 'Subarachnoid Haemorrhage')
plt.bar(X_axis + 0.2, z_tias_crude, 0.4, label = 'TIAs and related syndromes')
plt.xticks(X_axis, x)
plt.xlabel("Gender")
plt.ylabel("Mean Crude Rate")
plt.title("Mean Crude Rate by Stroke Type & Gender")
plt.legend()
plt.show()
y_sub_crude = [19.70330, 10.87919]
z_tias_crude = [36.66311, 35.04374]
X_axis = np.arange(len(x))
plt.bar(X_axis - 0.2, y_sub_crude, 0.4, label = 'Female')
plt.bar(X_axis + 0.2, z_tias_crude, 0.4, label = 'Male')
plt.xticks(X_axis, x)
plt.xlabel("Stroke Type")
plt.ylabel("Mean Crude Rate")
plt.title("Mean Crude Rate by Stroke Type & Gender")
plt.legend()
plt.show()
library(reticulate)
library(janitor)
py_install("pyprojroot")
reticulate::repl_python()
library(tidyverse)
py$stroke_activity_hb %>%
distinct(Diagnosis)
# clean names using janitor package
stroke_activity_hb <- py$stroke_activity_hb %>%
clean_names()
reticulate::repl_python()
library(reticulate)
library(janitor)
py_install("pyprojroot")
reticulate::repl_python()
library(tidyverse)
py$stroke_activity_hb %>%
distinct(Diagnosis)
# clean names using janitor package
stroke_activity_hb <- py$stroke_activity_hb %>%
clean_names()
reticulate::repl_python()
library(reticulate)
library(reticulate)
library(janitor)
py_install("pyprojroot")
reticulate::repl_python()
library(tidyverse)
py$stroke_activity_hb %>%
distinct(Diagnosis)
# clean names using janitor package
stroke_activity_hb <- py$stroke_activity_hb %>%
clean_names()
reticulate::repl_python()
py$age_group_df
py$age_group_df %>%
group_by(age_group) %>%
summarise(avg_crude_rate = mean(crude_rate))
reticulate::repl_python()
py$age_group_df %>%
group_by(age_group)
py$age_group_df %>%
group_by(age_group, financial_year) %>%
summarise(avg_crude_rate = mean(crude_rate))
py$age_group_df %>%
filter(crude_rate != "NaN") %>%
group_by(age_group, financial_year) %>%
summarise(avg_crude_rate = mean(crude_rate))
py$age_group_df %>%
filter(crude_rate != "NaN") %>%
group_by(age_group, financial_year) %>%
summarise(avg_crude_rate = mean(crude_rate)) %>%
ggplot(aes(x = financial_year, y = avg_crude_rate)) +
geom_line()
py$age_group_df %>%
filter(crude_rate != "NaN") %>%
group_by(age_group, financial_year) %>%
summarise(avg_crude_rate = mean(crude_rate)) %>%
ggplot(aes(x = financial_year, y = avg_crude_rate, fill = age_group)) +
geom_line()
py$age_group_df %>%
filter(crude_rate != "NaN") %>%
group_by(age_group, financial_year) %>%
summarise(avg_crude_rate = mean(crude_rate)) %>%
ggplot(aes(x = financial_year, y = avg_crude_rate, colour = age_group)) +
geom_line()
py$age_group_df %>%
filter(crude_rate != "NaN") %>%
group_by(age_group, financial_year) %>%
summarise(avg_crude_rate = mean(crude_rate)) %>%
ggplot(aes(x = financial_year, y = avg_crude_rate, colour = age_group)) +
geom_line(colour = age_group)
py$age_group_df %>%
filter(crude_rate != "NaN") %>%
group_by(age_group, financial_year) %>%
summarise(avg_crude_rate = mean(crude_rate)) %>%
ggplot(aes(x = financial_year, y = avg_crude_rate, colour = age_group)) +
geom_line(fill = age_group)
py$age_group_df %>%
filter(crude_rate != "NaN") %>%
group_by(age_group, financial_year) %>%
summarise(avg_crude_rate = mean(crude_rate)) %>%
ggplot(aes(x = financial_year, y = avg_crude_rate, colour = age_group)) +
geom_line()
py$age_group_df %>%
filter(crude_rate != "NaN") %>%
group_by(age_group, financial_year) %>%
summarise(avg_crude_rate = mean(crude_rate)) %>%
ggplot(aes(x = financial_year, y = avg_crude_rate, colour = age_group)) +
geom_line(aes(group = 1))
py$age_group_df %>%
filter(crude_rate != "NaN") %>%
group_by(age_group, financial_year) %>%
summarise(avg_crude_rate = mean(crude_rate)) %>%
ggplot(aes(x = financial_year, y = avg_crude_rate, colour = age_group)) +
geom_line(aes(group = 5))
py$age_group_df %>%
filter(crude_rate != "NaN") %>%
group_by(age_group, financial_year) %>%
summarise(avg_crude_rate = mean(crude_rate)) %>%
ggplot(aes(x = financial_year, y = avg_crude_rate, colour = age_group)) +
geom_line(aes(group = 2))
py$age_group_df %>%
filter(crude_rate != "NaN") %>%
group_by(age_group, financial_year) %>%
summarise(avg_crude_rate = mean(crude_rate)) %>%
ggplot(aes(x = financial_year, y = avg_crude_rate, colour = age_group)) +
geom_line(group = age_group)
py$age_group_df %>%
filter(crude_rate != "NaN") %>%
group_by(age_group, financial_year) %>%
summarise(avg_crude_rate = mean(crude_rate))
py$age_group_df %>%
filter(crude_rate != "NaN") %>%
group_by(age_group, financial_year) %>%
summarise(avg_crude_rate = mean(crude_rate)) %>%
ggplot(aes(x = financial_year, y = avg_crude_rate, colour = age_group)) +
geom_line(group = 1)
py$age_group_df %>%
filter(crude_rate != "NaN") %>%
group_by(age_group, financial_year) %>%
summarise(avg_crude_rate = mean(crude_rate)) %>%
ggplot() +
aes(x = financial_year, y = avg_crude_rate, colour = age_group) +
geom_line(group = 1)
py$age_group_df %>%
filter(crude_rate != "NaN") %>%
group_by(age_group, financial_year) %>%
summarise(avg_crude_rate = mean(crude_rate)) %>%
ggplot() +
aes(x = financial_year, y = avg_crude_rate, colour = age_group) +
geom_line()
py$age_group_df %>%
filter(crude_rate != "NaN") %>%
group_by(age_group, financial_year) %>%
summarise(avg_crude_rate = mean(crude_rate)) %>%
ggplot() +
aes(x = financial_year, y = avg_crude_rate, colour = age_group) +
geom_point()+
geom_line()
py$age_group_df %>%
filter(crude_rate != "NaN") %>%
group_by(age_group, financial_year) %>%
summarise(avg_crude_rate = mean(crude_rate)) %>%
ggplot() +
aes(x = financial_year, y = avg_crude_rate, colour = age_group) +
geom_point()+
geom_line(stat = identity)
py$age_group_df %>%
filter(crude_rate != "NaN") %>%
group_by(age_group, financial_year) %>%
summarise(avg_crude_rate = mean(crude_rate)) %>%
ggplot() +
aes(x = financial_year, y = avg_crude_rate, colour = age_group) +
geom_point()+
geom_line(group = 1)
py$age_group_df %>%
filter(crude_rate != "NaN") %>%
group_by(age_group, financial_year) %>%
summarise(avg_crude_rate = mean(crude_rate)) %>%
ggplot() +
aes(x = financial_year, y = avg_crude_rate, colour = age_group) +
geom_point()+
geom_line()
py$age_group_df %>%
filter(crude_rate != "NaN") %>%
group_by(age_group, financial_year) %>%
summarise(avg_crude_rate = mean(crude_rate)) %>%
ggplot() +
aes(x = financial_year, y = avg_crude_rate, colour = age_group) +
geom_point()+
geom_smooth()
py$age_group_df %>%
filter(crude_rate != "NaN") %>%
group_by(age_group, financial_year) %>%
summarise(avg_crude_rate = mean(crude_rate)) %>%
ggplot() +
aes(x = financial_year, y = avg_crude_rate, colour = age_group) +
geom_point()+
ggalt::geom_xspline()
install.packages("ggalt")
py$age_group_df %>%
filter(crude_rate != "NaN") %>%
group_by(age_group, financial_year) %>%
summarise(avg_crude_rate = mean(crude_rate)) %>%
ggplot() +
aes(x = financial_year, y = avg_crude_rate, colour = age_group) +
geom_point()+
ggalt::geom_xspline()
py$age_group_df %>%
filter(crude_rate != "NaN") %>%
group_by(age_group, financial_year) %>%
summarise(avg_crude_rate = mean(crude_rate)) %>%
as.tibble() %>%
ggplot() +
aes(x = financial_year, y = avg_crude_rate, colour = age_group) +
geom_point()+
ggalt::geom_xspline()
py$age_group_df %>%
filter(crude_rate != "NaN") %>%
group_by(age_group, financial_year) %>%
summarise(avg_crude_rate = mean(crude_rate)) %>%
ggplot() +
aes(x = financial_year, y = avg_crude_rate, colour = age_group) +
geom_point()+
ggalt::geom_xspline()
py$age_group_df %>%
filter(crude_rate != "NaN") %>%
group_by(age_group, financial_year) %>%
summarise(avg_crude_rate = mean(crude_rate)) %>%
ggplot() +
aes(x = financial_year, y = avg_crude_rate, colour = age_group) +
geom_point()+
geom_line(stat="identity")
py$age_group_df %>%
filter(crude_rate != "NaN") %>%
group_by(age_group, financial_year) %>%
summarise(avg_crude_rate = mean(crude_rate)) %>%
ggplot() +
aes(x = financial_year, y = avg_crude_rate) +
geom_point()+
geom_line(colour = age_group)
py$age_group_df %>%
filter(crude_rate != "NaN") %>%
group_by(age_group, financial_year) %>%
summarise(avg_crude_rate = mean(crude_rate)) %>%
ggplot() +
aes(x = financial_year, y = avg_crude_rate, color = age_group) +
geom_point()+
geom_line()
py$age_group_df %>%
filter(crude_rate != "NaN") %>%
group_by(age_group, financial_year) %>%
summarise(avg_crude_rate = mean(crude_rate)) %>%
ggplot() +
aes(x = financial_year, y = avg_crude_rate, colour = age_group) +
geom_point()+
geom_line()
py$age_group_df %>%
filter(crude_rate != "NaN") %>%
group_by(age_group, financial_year) %>%
summarise(avg_crude_rate = mean(crude_rate)) %>%
ggplot() +
aes(x = financial_year, y = avg_crude_rate, colour = age_group, group = age_group) +
geom_point()+
geom_line()
# age_group plot
py$age_group_df %>%
filter(crude_rate != "NaN") %>%
group_by(age_group, financial_year) %>%
summarise(avg_crude_rate = mean(crude_rate)) %>%
ggplot() +
aes(x = financial_year, y = avg_crude_rate, colour = age_group, group = age_group) +
geom_point()+
geom_line()+
ggtitle("Mean Crude Rate by Age Group")
# age_group plot
py$age_group_df %>%
filter(crude_rate != "NaN") %>%
group_by(age_group, financial_year) %>%
summarise(avg_crude_rate = mean(crude_rate)) %>%
ggplot() +
aes(x = financial_year, y = avg_crude_rate, colour = age_group, group = age_group) +
geom_point()+
geom_line()+
ggtitle("Mean Crude Rate by Age Group") +
labs(x = "Financial Year",
y = "Mean Crude Rate",
colour = "Age Group")
# age_group plot
py$age_group_df %>%
filter(crude_rate != "NaN") %>%
group_by(age_group, financial_year) %>%
summarise(avg_crude_rate = mean(crude_rate)) %>%
ggplot() +
aes(x = financial_year, y = avg_crude_rate, colour = age_group, group = age_group) +
geom_point()+
geom_line()+
ggtitle("Mean Crude Rate by Age Group") +
labs(x = "Financial Year",
y = "Mean Crude Rate",
colour = "Age Group") +
theme_bw()
# age_group plot
py$age_group_df %>%
filter(crude_rate != "NaN") %>%
group_by(age_group, financial_year) %>%
summarise(avg_crude_rate = mean(crude_rate)) %>%
ggplot() +
aes(x = financial_year, y = avg_crude_rate, colour = age_group, group = age_group) +
geom_point()+
geom_line()+
ggtitle("Mean Crude Rate by Age Group") +
labs(x = "Financial Year",
y = "Mean Crude Rate",
colour = "Age Group") +
theme_minimal()
reticulate::repl_python()
