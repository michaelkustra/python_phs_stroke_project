import pandas as pd
from pyprojroot import here
# model packages
import pandas_profiling
from sklearn.linear_model import LinearRegression
# profile_to_file(nnnn.html)
# read in mortality data
hb_mortality = pd.read_csv(here("raw_data/stroke_mortalitybyhbr.csv"))
ca_mortality = pd.read_csv(here("raw_data/stroke_mortalitybyca.csv"))
hb_mortality_reduced = r.hb_mortality.drop(columns = ['hbrqf', 'age_group_qf', 'sex_qf', 'number_of_deaths_qf', 'crude_rate_qf'])
View(hb_mortality_reduced)
hb_mortality_reduced = hb_mortality_reduced.query('age_group != "All" & sex != "All"').dropna()
View(hb_mortality_reduced)
hb_mortality_reduced.isna().sum()
# assign categorical vars dummies
hb_mortality_reduced = pd.get_dummies(hb_mortality_reduced, drop_first = True)
hb_mortality_reduced.head()
# set our response array
response_var = hb_mortality_reduced['number_of_deaths']
# put our predictors in a data frame
predictor_vars = hb_mortality_reduced.drop(columns = 'number_of_deaths')
# define model
mortality_model = LinearRegression()
mortality_model.fit(predictor_vars, response_var)
mortality_model.score(predictor_vars, response_var)
mortality_model.intercept_
mortlality_model.coef_
mortality_model.coef_
# match predictors to coefficients in a df
pd.DataFrame({
'Variable':predictor_var.columns,
'Coefficients':mortality_model.coef_
})
# match predictors to coefficients in a df
pd.DataFrame({
'Variable':predictor_vars.columns,
'Coefficients':mortality_model.coef_
})
import statsmodels.api as sm
import statsmodels.api as sm
# add in the constant to the data
predictor_vars = sm.add_constant(predictor_vars)
predictor_vars.head()
# model summary
sm_model = sm.OLS(response_var, predictor_vars).fit()
print(sm_model.summary())
reticulate::repl_python()
library(reticulate)
library(tidyverse)
py_install("pandas-profiling")
py_install("scikit-learn")
reticulate::repl_python()
hb_mortality <- py$hb_mortality %>%
janitor::clean_names()
reticulate::repl_python()
